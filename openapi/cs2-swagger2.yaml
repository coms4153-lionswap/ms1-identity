swagger: "2.0"
info:
  title: LionSwap Composite API
  version: "0.1.0"
  description: Composite service that coordinates deletion across Identity (ms1) and Catalog (ms2).

# Cloud Run host — REPLACE THIS with your composite service hostname
host: ms1-identity-157498364441.us-east1.run.app
basePath: /
schemes:
  - https

consumes:
  - application/json
produces:
  - application/json

paths:
  /composite/users/{uni}:
    delete:
      summary: Delete a user and all their listed items (ms1 + ms2)
      parameters:
        - name: uni
          in: path
          required: true
          type: string
      responses:
        200:
          description: Deleted successfully
          schema:
            type: object
            properties:
              ms1_identity:
                type: string
                enum: [deleted, not_found]
              ms2_catalog:
                type: string
                enum: [deleted, none, not_found]

        207:
          description: Partial success (one service failed)
          schema:
            type: object
            properties:
              ms1_identity:
                type: string
              ms2_catalog:
                type: string
              errors:
                type: array
                items:
                  type: string

        409:
          description: Conflict — blocked items prevent deletion
          schema:
            type: object
            properties:
              reason:
                type: string
                example: "Active reservations/sales exist"
              blocked_items:
                type: array
                items:
                  type: string

        404:
          description: User not found
